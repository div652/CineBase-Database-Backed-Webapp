with 
    totEpFilter as(
    select parenttitleid 
    from episode 
    group by parenttitleid 
    having count(*) >= {min_eps} and count(*) < {max_eps}
    ), 
    required_series_filter as(
    select titleid
    from episode
    where parenttitleid in (select * from totEpFilter)
    )
select * From episode t 
where 
({s_num_start}= -1 or t.seasonNumber >= {s_num_start})
and ({s_num_end} = -1 or t.seasonNumber <= {s_num_end})
and ({ep_num_start}= -1 or t.episodeNumber >= {ep_num_start})
and ({ep_num_end} = -1 or t.episodeNumber <= {ep_num_end})
and ({min_eps}=0 AND {max_eps}=100000)
UNION
select * From episode t 
where 
({s_num_start}= -1 or t.seasonNumber >= {s_num_start})
and ({s_num_end} = -1 or t.seasonNumber <= {s_num_end})
and ({ep_num_start}= -1 or t.episodeNumber >= {ep_num_start})
and ({ep_num_end} = -1 or t.episodeNumber <= {ep_num_end})
and (  t.titleid in (select * from required_series_filter));
